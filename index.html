<!-- PASO 1: de momento agregamos title, style y canva -->

<title>Arkanoid en Js</title>
<style>
    body{
        background-color: #111;
    }

    canvas{
        border: 4px solid #fff;
        border-bottom: transparent;
        background: #000;
        margin: 0 auto;
        display: block;
    }
</style>

<canvas></canvas>

<!-- PASO 2: recuperamos la etiqueta canva en js -->
<script>
    const canvas = document.querySelector("canvas")

    //paso 3 agregamos el contexto en 2d, aunque hay varios
    const ctx = canvas.getContext('2d')

    //paso 4 agregamos tamaño de resolucion
    canvas.width = 448
    canvas.height = 400
    //paso 6.1 agregamos las funciones a utilizar y las variables de cada objeto
    //variables de la pelota
    const ballRadius = 4; //tamaño de la pelota

    //localizacion de la pelota, x/y va a cambiar constantemente
    let x = canvas.width/2
    let y = canvas.height - 30

    //velocidad de la pelota
    let dx = -2 /*paso 10.1: cambiamos el valor a negativo para ver el rebote hacia la iquierda*/
    let dy = -2
    //paso 7 empezaremos a dibujar
    function drawBall(){
        ctx.beginPath()
        ctx.arc(x, y, ballRadius, 0, Math.PI * 3)
        ctx.fillStyle = '#fff'
        ctx.fill()
        ctx.closePath()
    }
    function drawPaddle(){}
    function drawBricks(){}

    function collisionDetection(){}
    //paso 8 damos movimiento a la pelota
    function ballMovement(){
        //paso 10: rebotar las pelotas en los laterales
        if (x + dx > canvas.width - ballRadius /*la pared derecha*/|| 
            x + dx < ballRadius /*la pared izquierda*/) {
            dx = -dx
        }

        //paso 11: rebotar la pelota en la parte de arriba y la idea es de que si cae la pelota pues perdimos
        if (y + dy <ballRadius) {
            dy = -dy
        }

        //paso 12: una especie de game over cuando la pelota toca el suelo
        if (y + dy > canvas.height - ballRadius) {
            console.log('Game Over')
            document.location.reload()/*para que recargue una vez hayas perdido*/
        }

        x += dx
        y += dy
    }
    function paddleMovement(){}

    //paso 9: para limpiar la pantalla por asi decirlo y la llamamos en la funcion draw
    function cleanCanvas(){
        ctx.clearRect(0, 0, canvas.width, canvas.height)
    }

    //paso 5 agregaremos recursividad
    //esta es la base de cualquier juego requestAnimationFrame
    //estamos en un "loop infinito" ya que se carga la pantalla 60 frames x minuto
    function draw(){
        //esto hace que vaya dibujando y limpiando la pantalla, ademas de que la pelota desaparece debido a que aun no hay colisiones
        cleanCanvas()
        //aqui haras tus dibujos y checks de colisiones
        //paso 6 dibujamos los elementos con funciones
        drawBall()
        drawPaddle()
        drawBricks()

        //colisiones y moviemientos
        collisionDetection()
        ballMovement()
        paddleMovement()


        window.requestAnimationFrame(draw)
    }

    draw()
</script>
